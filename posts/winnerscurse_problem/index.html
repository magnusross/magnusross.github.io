<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Winners curse in Bayesian optimisation | Magnus Ross</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/slideshow.css" />
<link rel="stylesheet" href="/css/music-toggle.css" />
  </head>

  <body>
    <nav style="position: relative;">
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/posts">Posts</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
      <li><a href="/index.xml">RSS Feed</a></li>
      
      <li class="music-toggle-container">
        <button id="music-toggle" class="music-toggle" title="Click to toggle music • Right-click for info">
          <span class="music-icon">♪</span>
          <div class="toggle-switch">
            <div class="toggle-slider"></div>
          </div>
        </button>
      </li>
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Winners curse in Bayesian optimisation</span></h1>

<h2 class="date">2023/03/14</h2>
</div>

<main>
<p><strong>Problem</strong></p>
<p>Take an objective function \( f(x) \) with GP prior and i.i.d. Gaussian noise with variance \( \sigma^2 \), so \( y_i = f(x_i) + \epsilon_i \) with \( \epsilon_i \sim \mathcal{N}(0, \sigma^2) \). Assume two locations \( x_1, x_2 \) are sufficiently separated that their function values \( f(x_1) \) and \( f(x_2) \) are independent. Compute the posterior \( p(\epsilon_1-\epsilon_2|y_1, y_2) \) and use it to justify that the expected improvement in Bayesian optimisation suffers winners curse for a noisy objective. The winners curse says that for noisy optimisation problems, the lowest value is also likely the most noisy.</p>
<p>Source: Probabilistic Numerics by Henning, Osborne and Kersting, Ex. 32.2</p>
<p><strong>Solution</strong></p>
<p>First we need to compute \( p(\epsilon_i| y_i) \), which we can do using Bayes rule,
</p>
$$
p(\epsilon_i| y_i) = \frac{p(y_i| \epsilon_i)p(\epsilon_i)}{p(y_i)}
$$<p>
we have that \( p(\epsilon_i) = \mathcal{N}(\epsilon_i; 0, \sigma^2) \), and that \( p(y_i| \epsilon_i) =  \mathcal{N}(y_i; \epsilon_i, \sigma_f^2) \) where we have assumed that the prior over \( f \) has 0 mean, and variance \( \sigma_f^2 \). So we have,
</p>
$$
p(\epsilon_i| y_i) \propto \mathcal{N}(y_i; \epsilon_i, \sigma_f^2)\mathcal{N}(\epsilon_i; 0, \sigma^2)
$$<p>
which we can identify as a product of Gaussian PDFs. This results in another Gaussian PDF, see e.g <a href="http://www.lucamartino.altervista.org/2003-003.pdf">these notes</a>,
</p>
$$
p(\epsilon_i| y_i) = \mathcal{N}(\epsilon_i; \mu_{\epsilon_i}, \sigma^2_{\epsilon_i}),
$$<p>
where
\begin{align}
\mu_{\epsilon_i} &amp;= \frac{y_i\sigma^2}{\sigma^2 + \sigma_f^2}, \\\
\sigma^2_{\epsilon_i} &amp;= \frac{\sigma_f^2\sigma^2}{\sigma^2 + \sigma_f^2}.
\end{align}
We can see here that the variance is independent of data. Now we have computed the posterior of the noise given the data, we can compute the posterior of the difference between the noises given the data. Since the function values at the input points are independent then the posterior over the difference is just the difference of independent Gaussian random variables, in which case we simply subtract the means and sum the variances, to give
</p>
$$
p(\epsilon_1 - \epsilon_2=\Delta| y_1, y_2) = \mathcal{N}\left(\Delta; \frac{\sigma^2}{\sigma^2 + \sigma_f^2}(y_1-y_2), 2\sigma^2_{\epsilon}\right).
$$<p>
The key point here is that the mean of this distribution depends on the difference between the data values. So
</p>
$$
y_1>y_2 \implies \mathbb{E}[\epsilon_1 - \epsilon_2]> 0 \implies \mathbb{E}[\epsilon_1] > \mathbb{E}[\epsilon_2].
$$<p>
If we assume that the values are lower that the prior mean (i.e. 0), which is to be expected, then we expect the noise for the lower point to be a larger (absolute) value. This is the winners curse described in the book.</p>

</main>

  <footer>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script defer src="//cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script defer src="//cdn.jsdelivr.net/npm/katex/dist/contrib/auto-render.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      
      delimiters: [
        {left: '$$', right: '$$', display: true},
        {left: '\\(', right: '\\)', display: false},
        
        {left: '\\begin{equation}', right: '\\end{equation}', display: true},
        {left: '\\begin{align}', right: '\\end{align}', display: true},
        {left: '\\begin{alignat}', right: '\\end{alignat}', display: true},
        {left: '\\begin{gather}', right: '\\end{gather}', display: true},
        {left: '\\begin{CD}', right: '\\end{CD}', display: true},
        {left: '\\[', right: '\\]', display: true}
      ],
      ignoredTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'option'],
      throwOnError: false,
      trust: (context) => ['\\href', '\\url', '\\includegraphics'].includes(context.command),
      strict: false
    });
  });
</script>

<script src="//cdn.jsdelivr.net/npm/@xiee/utils/js/center-img.min.js" defer></script>


<audio id="music-player" loop>
  <source src="/REC-2026-01-31.wav" type="audio/wav">
</audio>

<script>
  (function() {
    const musicToggle = document.getElementById('music-toggle');
    const musicPlayer = document.getElementById('music-player');
    
    if (!musicToggle || !musicPlayer) return;
    
    
    musicToggle.addEventListener('click', function(e) {
      if (musicPlayer.paused) {
        musicPlayer.play();
        musicToggle.classList.add('playing');
      } else {
        musicPlayer.pause();
        musicPlayer.currentTime = 0;
        musicToggle.classList.remove('playing');
      }
    });
    
    
    musicToggle.addEventListener('contextmenu', function(e) {
      e.preventDefault();
      window.location.href = '\/music\/';
    });
  })();
</script>

  
  <hr/>
  © <a href="https://magnusross.github.io">Magnus Ross</a> &ndash; 2026
  
  </footer>
  </body>
</html>

